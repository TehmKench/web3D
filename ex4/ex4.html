<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Espacio Fragmentado</title>

  <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>

  <script>
AFRAME.registerComponent("mylink", {
  schema: {
    href: { type: 'string' }
  },
  init: function () {
    this.el.addEventListener("click", () => {
      window.location.href = this.data.href;
    });
  }
});
    /* =========================
       ESTRELLAS FONDO ESPACIAL
    ========================== */
    AFRAME.registerComponent('estrellas', {
      schema: {
        cantidad: { type: 'int', default: 3000 },
        radio: { type: 'number', default: 120 }
      },

      init: function () {
        const scene = this.el.sceneEl.object3D;
        const geometry = new THREE.BufferGeometry();
        const positions = [];

        for (let i = 0; i < this.data.cantidad; i++) {
          positions.push(
            (Math.random() - 0.5) * this.data.radio,
            (Math.random() - 0.5) * this.data.radio,
            (Math.random() - 0.5) * this.data.radio
          );
        }

        geometry.setAttribute(
          'position',
          new THREE.Float32BufferAttribute(positions, 3)
        );

        const material = new THREE.PointsMaterial({
          color: 0xffffff,
          size: 0.18,
          transparent: true,
          opacity: 0.9
        });

        this.stars = new THREE.Points(geometry, material);
        scene.add(this.stars);
      },

      tick: function (time, delta) {
        this.stars.rotation.y += delta * 0.00002;
        this.stars.rotation.x += delta * 0.00001;
      }
    });

    /* =========================
       MOVIMIENTO RANDOM
    ========================== */
    AFRAME.registerComponent('movimiento-random', {
      init: function () {
        this.el.addEventListener('click', () => {
          const x = (Math.random() * 10 - 5).toFixed(2);
          const y = (Math.random() * 6 + 1).toFixed(2);
          const z = (Math.random() * -10 - 3).toFixed(2);

          this.el.setAttribute('animation__move', {
            property: 'position',
            to: `${x} ${y} ${z}`,
            dur: 2500,
            easing: 'easeInOutQuad'
          });
        });
      }
    });

    /* =========================
       PLANETA VIVO
    ========================== */
    AFRAME.registerComponent('planeta-vivo', {
      init: function () {
        const colores = ['#8B0000', '#2E8B57', '#4B0082', '#B8860B'];

        this.el.addEventListener('mouseenter', () => {
          this.el.setAttribute('animation__pulse', {
            property: 'scale',
            to: '1.15 1.15 1.15',
            dur: 400,
            dir: 'alternate',
            loop: true
          });
        });

        this.el.addEventListener('mouseleave', () => {
          this.el.removeAttribute('animation__pulse');
          this.el.setAttribute('scale', '1 1 1');
        });

        this.el.addEventListener('dblclick', () => {
          this.el.setAttribute(
            'color',
            colores[Math.floor(Math.random() * colores.length)]
          );
        });
      }
    });
    /* =========================
       ORBITA AUTOMATICA
    ========================== */
    AFRAME.registerComponent('orbita', {
  schema: {
    radio: { type: 'number', default: 4 },
    velocidad: { type: 'number', default: 0.6 },
    altura: { type: 'number', default: 0 }
  },

  init: function () {
    this.angulo = Math.random() * Math.PI * 2;
  },

  tick: function (time, delta) {
    this.angulo += this.data.velocidad * (delta / 1000);

    const x = Math.cos(this.angulo) * this.data.radio;
    const z = Math.sin(this.angulo) * this.data.radio;

    this.el.setAttribute('position', {
      x: x,
      y: this.data.altura,
      z: z
    });
  }
});

    /* =========================
       ANILLOS CAÓTICOS
    ========================== */
    AFRAME.registerComponent('anillo-caotico', {
      init: function () {
        this.el.addEventListener('mouseenter', () => {
          this.el.setAttribute('animation__tilt', {
            property: 'rotation',
            to: '110 360 0',
            dur: 1000,
            loop: true
          });
        });

        this.el.addEventListener('mouseleave', () => {
          this.el.removeAttribute('animation__tilt');
        });

        this.el.addEventListener('click', () => {
          this.el.setAttribute('animation__out', {
            property: 'position',
            to: '0 1.5 0',
            dur: 400,
            easing: 'easeOutQuad'
          });

          setTimeout(() => {
            this.el.setAttribute('animation__back', {
              property: 'position',
              to: '0 0 0',
              dur: 800,
              easing: 'easeInOutQuad'
            });
          }, 500);
        });
      }
    });
       
  </script>
</head>

<body>
<a-scene
  cursor="rayOrigin: mouse"
  background="color: #000000"
  estrellas>

  <!-- CÁMARA -->
  <a-entity camera look-controls wasd-controls="false">
    <a-entity cursor
      position="0 0 -1"
      geometry="primitive: ring; radiusInner: 0.015; radiusOuter: 0.025"
      material="color: white; shader: flat">
    </a-entity>
  </a-entity>

  <!-- SATURNO -->
  <a-entity position="3 2 -6" movimiento-random>

    <!-- PLANETAS -->
<a-entity position="0 2 -8">

  <!-- PLANETA 1 -->
  <a-entity position="-5 0 0">
  <a-sphere
  radius="0.8"
  color="#8B0000"
  mylink="href: https://pistacho666.github.io/web3/ex5/ex5.html"
  planeta-vivo>
</a-sphere>

  </a-entity>

  <!-- PLANETA 2 -->
  <a-entity position="-2.5 0 0">
    <a-sphere radius="0.8" color="#1E90FF" planeta-vivo></a-sphere>
  </a-entity>

  <!-- PLANETA CENTRAL (CON ANILLOS) -->
  <a-entity position="0 0 0">

    <a-sphere radius="0.8" color="#FFD700" planeta-vivo></a-sphere>

    <!-- ANILLOS -->
    <a-torus
      radius="1.2"
      radius-tubular="0.05"
      rotation="90 0 0"
      color="#FFD700">
    </a-torus>

    <a-torus
      radius="1.5"
      radius-tubular="0.03"
      rotation="90 0 0"
      color="#FFD700">
    </a-torus>

  </a-entity>

  <!-- PLANETA 4 -->
  <a-entity position="2.5 0 0">
    <a-sphere radius="0.8" color="#2E8B57" planeta-vivo></a-sphere>
  </a-entity>

  <!-- PLANETA 5 -->
  <a-entity position="5 0 0">
    <a-sphere radius="0.8" color="#8A2BE2" planeta-vivo></a-sphere>
  </a-entity>

</a-entity>

    <!-- LEVITACIÓN -->
    <a-animation
      attribute="position"
      from="0 -0.3 0"
      to="0 0.3 0"
      dur="1200"
      direction="alternate"
      repeat="indefinite">
    </a-animation>

  </a-entity>

</a-scene>
</body>
</html>
